import{r as c}from"./index.BiFHKRHA.js";let i=[],s=0;const o=4;let p=r=>{let n=[],e={get(){return e.lc||e.listen(()=>{})(),e.value},lc:0,listen(t){return e.lc=n.push(t),()=>{for(let u=s+o;u<i.length;)i[u]===t?i.splice(u,o):u+=o;let l=n.indexOf(t);~l&&(n.splice(l,1),--e.lc||e.off())}},notify(t,l){let u=!i.length;for(let f of n)i.push(f,e.value,t,l);if(u){for(s=0;s<i.length;s+=o)i[s](i[s+1],i[s+2],i[s+3]);i.length=0}},off(){},set(t){let l=e.value;l!==t&&(e.value=t,e.notify(l))},subscribe(t){let l=e.listen(t);return t(e.value),l},value:r};return e};function E(r,n,e){let t=new Set([...n,void 0]);return r.listen((l,u,f)=>{t.has(f)&&e(l,u,f)})}const h=p(!1);let a=(r,n)=>e=>{r.current=e,n()};function S(r,{keys:n,deps:e=[r,n]}={}){let t=c.useRef();t.current=r.get();let l=c.useCallback(f=>n?.length>0?E(r,n,a(t,f)):r.listen(a(t,f)),e),u=()=>t.current;return c.useSyncExternalStore(l,u,u)}export{h as i,S as u};
