import{r as o}from"./index.rE2EVDCa.js";let i=[],f=0;const c=4;let d=n=>{let u=[],e={get(){return e.lc||e.listen(()=>{})(),e.value},lc:0,listen(t){return e.lc=u.push(t),()=>{for(let r=f+c;r<i.length;)i[r]===t?i.splice(r,c):r+=c;let l=u.indexOf(t);~l&&(u.splice(l,1),--e.lc||e.off())}},notify(t,l){let r=!i.length;for(let s of u)i.push(s,e.value,t,l);if(r){for(f=0;f<i.length;f+=c)i[f](i[f+1],i[f+2],i[f+3]);i.length=0}},off(){},set(t){let l=e.value;l!==t&&(e.value=t,e.notify(l))},subscribe(t){let l=e.listen(t);return t(e.value),l},value:n};return e};function p(n,u,e){let t=new Set([...u,void 0]);return n.listen((l,r,s)=>{t.has(s)&&e(l,r,s)})}let a=(n,u)=>e=>{n.current!==e&&(n.current=e,u())};function S(n,{keys:u,deps:e=[n,u]}={}){let t=o.useRef();t.current=n.get();let l=o.useCallback(s=>(a(t,s)(n.value),u?.length>0?p(n,u,a(t,s)):n.listen(a(t,s))),e),r=()=>t.current;return o.useSyncExternalStore(l,r,r)}const b=d(!1),v=d(void 0);export{b as i,v as s,S as u};
